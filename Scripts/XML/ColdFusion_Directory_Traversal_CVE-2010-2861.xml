<?xml version="1.0" encoding="utf-8"?>
<WebApplicationTest>
	<TestDescription name="ColdFusion directory traversal" version="0.1" released="20040327" updated="20140310" protocol="HTTP" mayproxy="true" affects="file" severity="high" alert="success" type="Informational">
		<WASPDescription BindAlertToFile="0" CrawlerProcessingMode="ParseOnly" TargetFormat="${file}" Target="" ModuleName="" Request="" Response="" FullResponse="" DetailsFormat="" Details="" AuthType="0" AuthName="" AuthPass="" CompInfo="" FolowRedirection="false" DetaliedInformation="" SendCookies="true" AlertTags="directory_traversal,missing_update" CVE="CVE-2010-2861" CWE="CWE-22" CVSSVer="2.0" CVSSScore="7.5" CVSSDescr="AV:N/AC:L/Au:N/C:P/I:P/A:P/E:POC/RL:OF/RC:C" CVSSScoreTemp="5.9" CVSSScoreEnv="6.0" CVSS3Descr="CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"></WASPDescription>
		<Reference database="Security update: Hotfix available for ColdFusion" URL="http://www.adobe.com/support/security/bulletins/apsb10-18.html"></Reference>
		<Reference database="Vulnerability Summary for CVE-2010-2861" URL="http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-2861"></Reference>
		<Reference database="Coldfusion Directory Traversal Faq (CVE-2010-2861)" URL="http://www.gnucitizen.org/blog/coldfusion-directory-traversal-faq-cve-2010-2861/"></Reference>
		<Reference database="ColdFusion : Security Hot fix for the bulletin APSB10-18" URL="http://kb2.adobe.com/cps/857/cpsid_85766.html"></Reference>
		<Copyright></Copyright>
		<Description>Directory traversal vulnerability in Adobe ColdFusion 9.0.1 and earlier allows attackers to obtain sensitive information. The vulnerability is a variation of a classic directory traversal vulnerability, also referred to as 'arbitrary file retrieval'. The attack involves tricking a server-side script to provide the contents of a file that it was not originally supposed to be made available. By 'moving up' a few directory levels, the attacker is able to obtain the contents of files outside the application server's webroot via special strings such as '../'.</Description>
		<ApplicableTo>
			<Platform>
				<OS>Windows</OS>
				<Arch>i386</Arch>
			</Platform>
			<WebServer>IIS</WebServer>
			<ApplicationServer>All</ApplicationServer>
		</ApplicableTo>
		<TriggerOn event="scheme_host_port">
			<Match type="regex">.*</Match>
		</TriggerOn>
		<Impact>Once the attacker has gained access to the CF admin console, it might be possible to fully compromise the underlying OS.</Impact>
		<Recommendation>Apply the fix provided by Adobe. Check Web References.</Recommendation>
	</TestDescription>
	<Connection scheme="${scheme}" host="${host}" port="${port}">
		<Step name="first">
			<Request>
				<MessageHeader>
					<Method>OPTIONS</Method>
					<URI>${scheme}://${host}:${port}/</URI>
					<Version>HTTP/1.0</Version>
				</MessageHeader>
				<MessageBody>
					<Separator></Separator>
				</MessageBody>
			</Request>
			<Response>
				<SetVariable name="ResponseCode" type="string">
					<Description>The HTTP Response Code</Description>
					<Source source="status">^.*\s(\d\d\d)\s</Source>
				</SetVariable>
				<SetVariable name="FullBody" type="string">
					<Description>The HTTP Response Code</Description>
					<Source source="body">^(.*)$</Source>
				</SetVariable>
				<SetVariable name="redir302" type="string">
					<Description>Check to see if we are being redirected to another page</Description>
					<Source source="header">^Location: (.*)$</Source>
				</SetVariable>
				<SetVariable name="FullHeaders" type="string">
					<Description>Get full HTTP headers</Description>
					<Source source="header">^(.*)$</Source>
				</SetVariable>
			</Response>
			<TestCriteria type="success">
				<Compare variable="${ResponseCode}" test="eq">
					<Value>200</Value>
					<Compare variable="${IsCustom404}" test="eq">
						<Value>false</Value>
						<Compare variable="${FullHeaders}" test="cont">
							<Value>DASL:</Value>
							<Compare variable="${FullHeaders}" test="cont">
								<Value>DAV:</Value>
								<Compare variable="${FullHeaders}" test="cont">
									<Value>PROPFIND</Value>
								</Compare>
								<Compare variable="${FullHeaders}" test="cont">
									<Value>PROPPATCH</Value>
								</Compare>
								<Compare variable="${FullHeaders}" test="cont">
									<Value>LOCK</Value>
								</Compare>
								<Compare variable="${FullHeaders}" test="cont">
									<Value>SEARCH</Value>
								</Compare>
								<Compare variable="${FullHeaders}" test="cont">
									<Value>MKCOL</Value>
								</Compare>
								<Compare variable="${FullHeaders}" test="cont">
									<Value>UNLOCK</Value>
								</Compare>
							</Compare>
						</Compare>
					</Compare>
				</Compare>
			</TestCriteria>
			<TestCriteria type="failure">
				<Compare variable="${ResponseCode}" test="eq">
					<Value>404</Value>
				</Compare>
			</TestCriteria>
			<TestCriteria type="failure">
				<Compare variable="${ResponseCode}" test="eq">
					<Value>302</Value>
				</Compare>
			</TestCriteria>
			<TestCriteria type="failure">
				<Compare variable="${ResponseCode}" test="neq">
					<Value>200</Value>
				</Compare>
			</TestCriteria>
		</Step>
	</Connection>
	<Variable name="file" type="string">
		<Description>Affected site file</Description>
		<Item encoding="Text">test</Item>
	</Variable>
</WebApplicationTest>