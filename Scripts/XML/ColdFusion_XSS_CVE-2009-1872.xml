<?xml version="1.0" encoding="utf-8"?>
<WebApplicationTest>
	<TestDescription name="Adobe Coldfusion 8 multiple linked XSS vulnerabilies" version="0.1" released="20040327" updated="20150311" protocol="HTTP" mayproxy="true" affects="file" severity="high" alert="success" type="Informational">
		<WASPDescription BindAlertToFile="0" CrawlerProcessingMode="ParseOnly" TargetFormat="${file}" Target="" ModuleName="" Request="" Response="" FullResponse="" DetailsFormat="" Details="" AuthType="0" AuthName="" AuthPass="" CompInfo="" FolowRedirection="false" DetaliedInformation="" SendCookies="true" AlertTags="csrf,missing_update,xss" CVE="CVE-2009-1872" CWE="CWE-79" CVSSVer="2.0" CVSSScore="4.4" CVSSDescr="AV:N/AC:M/Au:N/C:N/I:P/A:N/E:POC/RL:OF/RC:C" CVSSScoreTemp="" CVSSScoreEnv="" CVSS3Descr="CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N"></WASPDescription>
		<Reference database="CVE-2009-1872" URL="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1872"></Reference>
		<Reference database="[DSECRG-09-022] Adobe Coldfusion 8 - Multiple Linked XSS Vulnerabilies " URL="http://www.dsecrg.com/pages/vul/show.php?id=122"></Reference>
		<Reference database="Security Update: Hotfixes available for ColdFusion and JRun" URL="http://www.adobe.com/go/apsb09-12"></Reference>
		<Copyright></Copyright>
		<Description>Multiple Linked XSS and XSRF vulnerabilities were found in Adobe Coldfusion Server 8. [break][break]
Cross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user.
Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser.</Description>
		<ApplicableTo>
			<Platform>
				<OS>Windows</OS>
				<Arch>i386</Arch>
			</Platform>
			<WebServer>IIS</WebServer>
			<ApplicationServer>All</ApplicationServer>
		</ApplicableTo>
		<TriggerOn event="scheme_host_port">
			<Match type="regex">.*</Match>
		</TriggerOn>
		<Impact>Malicious users may inject JavaScript, VBScript, ActiveX, HTML or Flash into a vulnerable application to fool a user in order to gather data from them.
An attacker can steal the session cookie and take over the account, impersonating the user.
It is also possible to modify the content of the page presented to the user.</Impact>
		<Recommendation>Apply patch from Adobe. Check Web References for details.</Recommendation>
	</TestDescription>
	<Connection scheme="${scheme}" host="${host}" port="${port}">
		<Step name="first">
			<Request>
				<MessageHeader>
					<Method>OPTIONS</Method>
					<URI>${scheme}://${host}:${port}/</URI>
					<Version>HTTP/1.0</Version>
				</MessageHeader>
				<MessageBody>
					<Separator></Separator>
				</MessageBody>
			</Request>
			<Response>
				<SetVariable name="ResponseCode" type="string">
					<Description>The HTTP Response Code</Description>
					<Source source="status">^.*\s(\d\d\d)\s</Source>
				</SetVariable>
				<SetVariable name="FullBody" type="string">
					<Description>The HTTP Response Code</Description>
					<Source source="body">^(.*)$</Source>
				</SetVariable>
				<SetVariable name="redir302" type="string">
					<Description>Check to see if we are being redirected to another page</Description>
					<Source source="header">^Location: (.*)$</Source>
				</SetVariable>
				<SetVariable name="FullHeaders" type="string">
					<Description>Get full HTTP headers</Description>
					<Source source="header">^(.*)$</Source>
				</SetVariable>
			</Response>
			<TestCriteria type="success">
				<Compare variable="${ResponseCode}" test="eq">
					<Value>200</Value>
					<Compare variable="${IsCustom404}" test="eq">
						<Value>false</Value>
						<Compare variable="${FullHeaders}" test="cont">
							<Value>DASL:</Value>
							<Compare variable="${FullHeaders}" test="cont">
								<Value>DAV:</Value>
								<Compare variable="${FullHeaders}" test="cont">
									<Value>PROPFIND</Value>
								</Compare>
								<Compare variable="${FullHeaders}" test="cont">
									<Value>PROPPATCH</Value>
								</Compare>
								<Compare variable="${FullHeaders}" test="cont">
									<Value>LOCK</Value>
								</Compare>
								<Compare variable="${FullHeaders}" test="cont">
									<Value>SEARCH</Value>
								</Compare>
								<Compare variable="${FullHeaders}" test="cont">
									<Value>MKCOL</Value>
								</Compare>
								<Compare variable="${FullHeaders}" test="cont">
									<Value>UNLOCK</Value>
								</Compare>
							</Compare>
						</Compare>
					</Compare>
				</Compare>
			</TestCriteria>
			<TestCriteria type="failure">
				<Compare variable="${ResponseCode}" test="eq">
					<Value>404</Value>
				</Compare>
			</TestCriteria>
			<TestCriteria type="failure">
				<Compare variable="${ResponseCode}" test="eq">
					<Value>302</Value>
				</Compare>
			</TestCriteria>
			<TestCriteria type="failure">
				<Compare variable="${ResponseCode}" test="neq">
					<Value>200</Value>
				</Compare>
			</TestCriteria>
		</Step>
	</Connection>
	<Variable name="file" type="string">
		<Description>Affected site file</Description>
		<Item encoding="Text">test</Item>
	</Variable>
</WebApplicationTest>