<?xml version="1.0" encoding="utf-8"?>
<WebApplicationTest>
	<TestDescription name="Security vulnerability in MySQL/MariaDB sql/password.c" version="0.1" released="20080307" updated="20140305" protocol="FTP" mayproxy="false" affects="server" severity="high" alert="success" type="Configuration">
		<WASPDescription BindAlertToFile="0" CrawlerProcessingMode="ParseOnly" TargetFormat="" Target="" ModuleName="" Request="" Response="" FullResponse="" DetailsFormat="" Details="" AuthType="0" AuthName="" AuthPass="" CompInfo="" DetaliedInformation="" AlertTags="authentication_bypass" CVE="CVE-2012-2122" CWE="CWE-287" CVSSVer="2.0" CVSSScore="5.1" CVSSDescr="AV:N/AC:H/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C" CVSSScoreTemp="4.3" CVSSScoreEnv="4.2" CVSS3Descr="CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N"></WASPDescription>
		<Copyright></Copyright>
		<Description>Sergei Golubchik posted to the oss-sec mailing list about a recently patched security flaw (CVE-2012-2122) in the MySQL and MariaDB database servers.  When a user connects to MariaDB/MySQL, a token (SHA over a password and a random scramble string) is calculated and compared
with the expected value. Because of incorrect casting, it might've
happened that the token and the expected value were considered equal,
even if the memcmp() returned a non-zero value. In this case
MySQL/MariaDB would think that the password is correct, even while it is
not.  Because the protocol uses random strings, the probability of
hitting this bug is about 1/256.
Which means, if one knows a user name to connect (and "root" almost
always exists), she can connect using *any* password by repeating
connection attempts. ~300 attempts takes only a fraction of second, so
basically account password protection is as good as nonexistent. [break][break]
Affected versions:[break]
[ul]
[li]All MariaDB and MySQL versions up to 5.1.61, 5.2.11, 5.3.5, 5.5.22 are
vulnerable.[/li]
[li]MariaDB versions from 5.1.62, 5.2.12, 5.3.6, 5.5.23 are not.[/li]
[li]MySQL versions from 5.1.63, 5.5.24, 5.6.6 are not.[/li]
[/ul]</Description>
		<ApplicableTo>
			<Platform>
				<OS>*</OS>
				<Arch>*</Arch>
			</Platform>
			<WebServer>*</WebServer>
			<ApplicationServer>*</ApplicationServer>
		</ApplicableTo>
		<Impact>An attacker can bypass MySQL authentication.</Impact>
		<Recommendation>Upgrade to the latest version of MySQL.</Recommendation>
		<Reference database="Security vulnerability in MySQL/MariaDB sql/password.c" URL="http://seclists.org/oss-sec/2012/q2/493"></Reference>
		<Reference database="CVE-2012-2122 : Serious Mysql Authentication Bypass Vulnerability" URL="http://thehackernews.com/2012/06/cve-2012-2122-serious-mysql.html?m=1"></Reference>
	</TestDescription>
</WebApplicationTest>